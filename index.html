<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Geometry Dash - Random Levels</title>
<style>
  body { margin: 0; overflow: hidden; background: #222; }
  canvas { display: block; background: #111; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gravity = 1;
let jumpPower = -15;
let player = { x: 100, y: canvas.height - 100, width: 50, height: 50, dy: 0 };
let obstacles = [];
let level = 0;
const maxLevels = 500; // Total random levels
let score = 0;

// Function to generate a random level
function generateLevel(levelNum) {
  let obs = [];
  let obstacleCount = Math.min(5 + Math.floor(levelNum / 10), 15); // increase obstacles with level
  for (let i = 0; i < obstacleCount; i++) {
    let width = 30 + Math.floor(Math.random() * 50);
    let gap = 200 + Math.floor(Math.random() * 200); // distance to next obstacle
    let prevX = obs.length ? obs[obs.length - 1].x : canvas.width;
    let height = Math.random() < 0.8 ? 50 : 100 + Math.floor(Math.random() * 100); // some taller obstacles for harder levels
    obs.push({ x: prevX + gap, y: canvas.height - height, width: width, height: height });
  }
  return obs;
}

// Load level
function loadLevel(n) {
  obstacles = generateLevel(n);
  player.y = canvas.height - player.height;
  player.dy = 0;
  score = 0;
}

// Jump control
document.addEventListener('keydown', e => {
  if (e.code === 'Space' || e.code === 'ArrowUp') {
    if (player.y + player.height >= canvas.height) {
      player.dy = jumpPower;
    }
  }
});

function update() {
  // Apply gravity
  player.dy += gravity;
  player.y += player.dy;

  if (player.y + player.height > canvas.height) {
    player.y = canvas.height - player.height;
    player.dy = 0;
  }

  // Move obstacles
  for (let obs of obstacles) {
    obs.x -= 5;
    // Collision detection
    if (player.x < obs.x + obs.width &&
        player.x + player.width > obs.x &&
        player.y < obs.y + obs.height &&
        player.y + player.height > obs.y) {
      alert("Game Over! Level " + (level + 1));
      loadLevel(level); // restart level
    }
  }

  // Check if level finished
  if (obstacles.every(o => o.x + o.width < 0)) {
    level++;
    if (level >= maxLevels) {
      alert("You completed all 500 levels! Congrats!");
      level = 0;
    }
    loadLevel(level);
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw player
  ctx.fillStyle = 'cyan';
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // Draw obstacles
  ctx.fillStyle = 'red';
  for (let obs of obstacles) {
    ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
  }

  // Draw level info
  ctx.fillStyle = 'white';
  ctx.font = '30px Arial';
  ctx.fillText("Level: " + (level + 1), 20, 40);
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

// Start game
loadLevel(level);
loop();
</script>
</body>
</html>
