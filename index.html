<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Geometry Dash</title>
<style>
  body { margin: 0; overflow: hidden; background: #222; }
  canvas { display: block; background: #111; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gravity = 1;
let jumpPower = -15;
let player = { x: 100, y: canvas.height - 100, width: 50, height: 50, dy: 0 };
let obstacles = [];
let level = 0;
let score = 0;

// Define levels (obstacles with position and width)
const levels = [
  // Level 0: Stereo Madness (Easy)
  [{x: 400, y: canvas.height-50, width: 50}, {x: 700, y: canvas.height-50, width: 50}, {x: 1000, y: canvas.height-50, width: 50}],
  // Level 1: Medium
  [{x: 400, y: canvas.height-50, width: 50}, {x: 600, y: canvas.height-50, width: 50}, {x: 800, y: canvas.height-100, width: 50}],
  // Level 2: Hard
  [{x: 300, y: canvas.height-50, width: 50}, {x: 500, y: canvas.height-150, width: 50}, {x: 700, y: canvas.height-50, width: 50}, {x: 900, y: canvas.height-200, width: 50}],
];

// Load current level
function loadLevel(n) {
  obstacles = levels[n].map(o => ({...o}));
  player.y = canvas.height - 100;
  player.dy = 0;
  score = 0;
}

// Jump control
document.addEventListener('keydown', e => {
  if (e.code === 'Space' || e.code === 'ArrowUp') {
    if (player.y + player.height >= canvas.height) {
      player.dy = jumpPower;
    }
  }
});

function update() {
  // Apply gravity
  player.dy += gravity;
  player.y += player.dy;

  if (player.y + player.height > canvas.height) {
    player.y = canvas.height - player.height;
    player.dy = 0;
  }

  // Move obstacles
  for (let obs of obstacles) {
    obs.x -= 5;
    // Collision detection
    if (player.x < obs.x + obs.width &&
        player.x + player.width > obs.x &&
        player.y < obs.y + 50 &&
        player.y + player.height > obs.y) {
      alert("Game Over! Level " + (level+1));
      loadLevel(level); // restart level
    }
  }

  // Check if level finished
  if (obstacles.every(o => o.x + o.width < 0)) {
    level++;
    if (level >= levels.length) {
      alert("You completed all levels!");
      level = 0;
    }
    loadLevel(level);
  }
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw player
  ctx.fillStyle = 'cyan';
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // Draw obstacles
  ctx.fillStyle = 'red';
  for (let obs of obstacles) {
    ctx.fillRect(obs.x, obs.y, obs.width, 50);
  }

  // Draw score
  ctx.fillStyle = 'white';
  ctx.font = '30px Arial';
  ctx.fillText("Level: " + (level+1), 20, 40);
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

// Start game
loadLevel(level);
loop();
</script>
</body>
</html>
